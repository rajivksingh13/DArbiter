version: "1.0"
name: "Combined Baseline"
patterns:
  - id: "pii.pan.india"
    label: "PAN"
    regex: "\\b[A-Z]{5}[0-9]{4}[A-Z]\\b"
    severity: "HIGH"
    category: "PII"
  - id: "pii.aadhaar.india"
    label: "Aadhaar"
    regex: "\\b[2-9]{1}[0-9]{3}\\s?[0-9]{4}\\s?[0-9]{4}\\b"
    severity: "HIGH"
    category: "PII"
  - id: "pii.ssn.us"
    label: "SSN"
    regex: "\\b(?!000|666|9\\d\\d)\\d{3}[- ]?(?!00)\\d{2}[- ]?(?!0000)\\d{4}\\b"
    severity: "CRITICAL"
    category: "PII"
  - id: "pii.email"
    label: "Email"
    regex: "(?i)\\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}\\b"
    severity: "MEDIUM"
    category: "PII"
  - id: "pii.phone"
    label: "Phone"
    regex: "\\b(?:\\+?\\d{1,3}[-.\\s]?)?(?:\\(?\\d{2,4}\\)?[-.\\s]?)?\\d{3,4}[-.\\s]?\\d{4}\\b"
    severity: "MEDIUM"
    category: "PII"
  - id: "secret.aws.access_key"
    label: "AWS Access Key"
    regex: "\\bAKIA[0-9A-Z]{16}\\b"
    severity: "CRITICAL"
    category: "SECRET"
  - id: "secret.aws.secret_key"
    label: "AWS Secret Key"
    regex: '(?i)aws(.{0,20})?["'']?[0-9a-zA-Z/+=]{40}["'']?'
    severity: "CRITICAL"
    category: "SECRET"
  - id: "secret.generic.key"
    label: "API Key"
    regex: "(?i)\\b(api[_-]?key|token|secret)\\b.{0,6}['\\\"][0-9a-zA-Z\\-_]{16,64}['\\\"]"
    severity: "HIGH"
    category: "SECRET"
  - id: "secret.jwt"
    label: "JWT"
    regex: "\\beyJ[a-zA-Z0-9_-]+?\\.[a-zA-Z0-9_-]+?\\.[a-zA-Z0-9_-]+?\\b"
    severity: "HIGH"
    category: "SECRET"
  - id: "secret.password"
    label: "Password"
    regex: "(?i)\\b(password|passwd|pwd)\\b.{0,6}['\\\"][^'\\\"]{6,}['\\\"]"
    severity: "HIGH"
    category: "SECRET"
  - id: "config.debug.true"
    label: "Debug Enabled"
    regex: "(?i)\\bDEBUG\\s*=\\s*true\\b"
    severity: "MEDIUM"
    category: "CONFIG_RISK"
  - id: "config.allow_all"
    label: "Allow All Enabled"
    regex: "(?i)\\bALLOW_ALL\\s*=\\s*true\\b"
    severity: "HIGH"
    category: "CONFIG_RISK"
  - id: "config.disable_auth"
    label: "Auth Disabled"
    regex: "(?i)\\bDISABLE_AUTH\\s*=\\s*true\\b"
    severity: "CRITICAL"
    category: "CONFIG_RISK"
  - id: "config.public_host"
    label: "Public Host Binding"
    regex: "(?i)\\b(0\\.0\\.0\\.0|0\\.0\\.0\\.0/0|::)\\b"
    severity: "HIGH"
    category: "CONFIG_RISK"
